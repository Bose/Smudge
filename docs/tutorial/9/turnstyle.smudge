turnstyle
{
   *power-on -(@lightLEDs)-> locked,

    locked (@lockedEnter)
    [
        coin -(@flashLEDs, coinInspector.validate)-> waiting-to-unlock,
        person -(@soundAlarm)-,
        tilt -(@soundAlarm)-,
        _ -(@soundError)-
    ] (@lockedExit),

    waiting-to-unlock
    [
        person -(@soundAlarm)-,
        coin-valid --> unlocked,
        coin-invalid --> locked
    ],

    unlocked (@unlockedEnter)
    [
        person -(@soundOkay)-> locked,
        tilt -(@soundAlarm)-> locked
    ],

    _
    [
        tilt -(@soundAlarm)-> locked
    ]
}

coinInspector
{
   *ready
    [
        validate -(@validateCoin)-,
        valid -(turnstyle.coin-valid)->ready,
        invalid -(turnstyle.coin-invalid)->ready
    ]
}
